<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.njwb.dao.VoteDao" >
<resultMap type="Vote" id="VoteResult">
		<id property="id" column="id" />
		<result property="user_id" column="user_id" />
		<result property="vote_name" column="vote_name" />
        <result property="vote_messages" column="vote_messages" />
        <result property="status" column="status" />
        <result property="create_time" column="create_time" />
        <result property="end_time" column="end_time" />
	</resultMap>

	<insert id="add" parameterType="Vote">
        insert into t_vote(user_id,vote_name,vote_messages,status,create_time,end_time) values(#{user_id},#{vote_name},#{vote_messages},#{status},#{create_time},#{end_time})
    </insert>

    <delete id="del" parameterType="Integer">
        delete from t_vote where id=#{id}
    </delete>

    <update id="mod" parameterType="Vote">
        update t_vote set user_id=#{user_id},vote_name=#{vote_name},vote_messages=#{vote_messages},status=#{status},create_time=#{create_time},end_time=#{end_time} where id=#{id}
    </update>


	<select id="queryById" resultType="Vote" parameterType="Integer">
		select * from t_vote where id=#{id} order by create_time desc
	</select>

	<select id="queryByUserId" parameterType="String"  resultMap="VoteResult">
		select * from t_vote where user_id=#{user_id} order by create_time desc
	</select>

    <select id="queryAll" resultMap="VoteResult">
        select * from t_vote order by create_time desc
    </select>

    <select id="queryByName" resultMap="VoteResult" parameterType="String">
		select * from t_vote where 1=1
        <if test="_parameter!=null">
			and vote_name  like CONCAT(CONCAT('%', #{vote_name}), '%')
		</if>
        order by create_time desc
	</select>

    <select id="queryVoteListNow"   resultMap="VoteResult">
		select * from t_vote where status=2 order by create_time desc
	</select>

    <select id="queryVoteListHistory"  resultMap="VoteResult">
		select * from t_vote where status=9 order by end_time desc
	</select>

    <select id="queryVoteListNowByUserId" parameterType="String"  resultMap="VoteResult">
		select * from t_vote where user_id=#{user_id} and status=2 order by create_time desc
	</select>

    <select id="queryVoteListHistoryByUserId" parameterType="String"  resultMap="VoteResult">
		select * from t_vote where user_id=#{user_id} and status=9 order by end_time desc
	</select>

    <select id="queryByNameAndStatus" parameterType="String"  resultType="Vote">
		select * from t_vote where vote_name=#{vote_name} and status=2 
	</select>
 </mapper>